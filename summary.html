<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Ø¹ÙÙˆÙ† - ØªÙ„Ø®ÙŠØµ PDF</title>
    
    <!-- Ù…ÙƒØªØ¨Ø© PDF.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Ø®Ø·ÙˆØ· Google -->
    <link href="https://fonts.googleapis.com/css2?family=Almarai:wght@300;400;700;800;900&family=Tajawal:wght@300;400;500;700;800;900&display=swap" rel="stylesheet">
    
    <style>
        /* Ø£Ù†Ø³Ø® ÙƒÙ„ CSS Ù…Ù† home.html Ù‡Ù†Ø§ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        :root {
            --bg-color: #F8FAFC;
            --card-color: #FFFFFF;
            --text-primary: #1E293B;
            --text-secondary: #64748B;
            --accent-dark: #0F172A;
            --black-gradient: linear-gradient(145deg, #0F172A, #1E293B);
            --border-radius: 24px;
            --border-radius-large: 32px;
            --navbar-height: 80px;
            --transition-quick: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --admin-color: #DC2626;
            --success-color: #059669;
            --warning-color: #D97706;
            --info-color: #3B82F6;
        }
        
        body {
            font-family: 'Almarai', 'Tajawal', -apple-system, sans-serif;
            background: var(--bg-color);
            color: var(--text-primary);
            min-height: 100vh;
            direction: rtl;
            -webkit-font-smoothing: antialiased;
        }
        
        .notification-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 99998;
            max-width: 400px;
            width: 100%;
        }
        
        .notification {
            background: white;
            border-radius: var(--border-radius);
            padding: 16px;
            margin-bottom: 12px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            border: 3px solid var(--accent-dark);
            transform: translateX(120%);
            transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 12px;
            cursor: grab;
            font-size: 0.85rem;
            opacity: 0;
        }
        
        .notification.show {
            transform: translateX(0);
            opacity: 1;
        }
        
        .notification-content {
            flex: 1;
        }
        
        .notification-title {
            font-family: 'Almarai', sans-serif;
            font-size: 0.95rem;
            font-weight: 800;
            color: var(--accent-dark);
            margin-bottom: 6px;
        }
        
        .notification-message {
            font-family: 'Tajawal', sans-serif;
            color: var(--text-secondary);
            font-size: 0.8rem;
            line-height: 1.5;
        }
        
        .notification-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 0.95rem;
            cursor: pointer;
            transition: var(--transition-quick);
            padding: 4px;
        }
        
        .notification-close:hover {
            color: var(--admin-color);
            transform: rotate(90deg);
        }
        
        .native-navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: var(--navbar-height);
            background: rgba(255, 255, 255, 0.96);
            backdrop-filter: saturate(200%) blur(30px);
            -webkit-backdrop-filter: saturate(200%) blur(30px);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 28px;
            z-index: 10000;
            border-bottom: 2px solid rgba(15, 23, 42, 0.1);
            box-shadow: 0 10px 40px rgba(15, 23, 42, 0.08);
            margin: 0 20px;
            top: 15px;
            width: calc(100% - 40px);
            border: 3px solid #0F172A;
            border-radius: 28px;
        }
        
        .logo {
            font-family: 'Almarai', sans-serif;
            font-weight: 900;
            font-size: 42px;
            background: linear-gradient(145deg, #0F172A, #334155);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -1.5px;
            cursor: pointer;
            transition: var(--transition-quick);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .logo:hover {
            transform: scale(1.05);
        }
        
        .nav-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .user-nav-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .coins-display {
            background: var(--black-gradient);
            color: white;
            padding: 12px 24px;
            border-radius: 20px;
            font-weight: 800;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 8px 24px rgba(15, 23, 42, 0.2);
            border: 3px solid #0F172A;
            transition: var(--transition-quick);
        }
        
        .coins-display:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(15, 23, 42, 0.3);
        }
        
        .coins-display i {
            font-size: 18px;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
        }
        
        .settings-btn {
            width: 52px;
            height: 52px;
            border-radius: 18px;
            background: white;
            border: 3px solid #0F172A;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition-quick);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
        }
        
        .settings-btn i {
            font-size: 24px;
            color: #0F172A;
            transition: var(--transition-quick);
        }
        
        .settings-btn:hover {
            transform: translateY(-3px) rotate(15deg);
            box-shadow: 0 12px 32px rgba(0, 0, 0, 0.15);
            background: var(--black-gradient);
        }
        
        .settings-btn:hover i {
            color: white;
            transform: scale(1.1);
        }
        
        .main-content {
            padding-top: calc(var(--navbar-height) + 60px);
            padding-left: 28px;
            padding-right: 28px;
            padding-bottom: 100px;
            max-width: 1300px;
            margin: 0 auto;
        }
        
        .service-header {
            text-align: center;
            margin-bottom: 50px;
            animation: fadeIn 0.8s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .service-title {
            font-family: 'Almarai', sans-serif;
            font-size: 3rem;
            font-weight: 900;
            margin-bottom: 20px;
            color: #0F172A;
            letter-spacing: -2px;
            line-height: 1.2;
        }
        
        .service-subtitle {
            font-family: 'Tajawal', sans-serif;
            font-size: 1.3rem;
            color: #64748B;
            max-width: 900px;
            margin: 0 auto;
            line-height: 1.7;
            font-weight: 500;
        }
        
        .upload-section {
            background: white;
            border-radius: var(--border-radius-large);
            padding: 40px;
            margin-bottom: 40px;
            border: 4px solid var(--accent-dark);
            box-shadow: 0 16px 48px rgba(0, 0, 0, 0.08);
            text-align: center;
            transition: var(--transition-quick);
        }
        
        .upload-zone {
            border: 3px dashed var(--accent-dark);
            border-radius: var(--border-radius);
            padding: 60px 40px;
            background: rgba(15, 23, 42, 0.02);
            cursor: pointer;
            transition: var(--transition-quick);
            margin-bottom: 30px;
        }
        
        .upload-zone:hover {
            background: rgba(15, 23, 42, 0.05);
            border-color: var(--info-color);
        }
        
        .upload-zone i {
            font-size: 64px;
            color: var(--accent-dark);
            margin-bottom: 20px;
            transition: var(--transition-quick);
        }
        
        .upload-zone:hover i {
            color: var(--info-color);
            transform: scale(1.1);
        }
        
        .upload-title {
            font-family: 'Almarai', sans-serif;
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--accent-dark);
            margin-bottom: 10px;
        }
        
        .upload-subtitle {
            font-family: 'Tajawal', sans-serif;
            color: var(--text-secondary);
            font-size: 1.1rem;
            margin-bottom: 15px;
        }
        
        .upload-note {
            font-family: 'Tajawal', sans-serif;
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-style: italic;
        }
        
        #file-input {
            display: none;
        }
        
        .file-info {
            background: rgba(15, 23, 42, 0.05);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-top: 20px;
            text-align: right;
            display: none;
        }
        
        .file-info.show {
            display: block;
            animation: fadeIn 0.5s ease-out;
        }
        
        .file-name {
            font-family: 'Almarai', sans-serif;
            font-weight: 800;
            color: var(--accent-dark);
            margin-bottom: 5px;
            word-break: break-all;
        }
        
        .file-size {
            font-family: 'Tajawal', sans-serif;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        .analysis-results {
            background: white;
            border-radius: var(--border-radius-large);
            padding: 40px;
            margin-bottom: 40px;
            border: 4px solid var(--accent-dark);
            box-shadow: 0 16px 48px rgba(0, 0, 0, 0.08);
            display: none;
        }
        
        .analysis-results.show {
            display: block;
            animation: fadeIn 0.5s ease-out;
        }
        
        .analysis-title {
            font-family: 'Almarai', sans-serif;
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--accent-dark);
            margin-bottom: 30px;
            text-align: center;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .stat-card {
            background: rgba(15, 23, 42, 0.05);
            border-radius: var(--border-radius);
            padding: 25px;
            text-align: center;
            border: 3px solid rgba(15, 23, 42, 0.1);
            transition: var(--transition-quick);
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            border-color: var(--info-color);
        }
        
        .stat-icon {
            width: 60px;
            height: 60px;
            background: var(--black-gradient);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            border: 3px solid #0F172A;
        }
        
        .stat-icon i {
            font-size: 24px;
            color: white;
        }
        
        .stat-value {
            font-family: 'Almarai', sans-serif;
            font-size: 2.2rem;
            font-weight: 900;
            color: var(--accent-dark);
            margin-bottom: 5px;
            line-height: 1;
        }
        
        .stat-label {
            font-family: 'Tajawal', sans-serif;
            color: var(--text-secondary);
            font-size: 1rem;
        }
        
        .cost-notice {
            background: linear-gradient(145deg, rgba(5, 150, 105, 0.1), rgba(5, 150, 105, 0.05));
            border: 3px solid var(--success-color);
            border-radius: var(--border-radius);
            padding: 25px;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .cost-text {
            font-family: 'Almarai', sans-serif;
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--success-color);
            margin-bottom: 10px;
        }
        
        .cost-subtext {
            font-family: 'Tajawal', sans-serif;
            color: var(--text-secondary);
            font-size: 1rem;
        }
        
        .confirmation-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
        }
        
        .btn {
            padding: 15px 40px;
            border: none;
            border-radius: var(--border-radius);
            font-family: 'Almarai', sans-serif;
            font-size: 1.1rem;
            font-weight: 800;
            cursor: pointer;
            transition: var(--transition-quick);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            min-width: 150px;
        }
        
        .btn-primary {
            background: var(--success-color);
            color: white;
            border: 3px solid var(--success-color);
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 32px rgba(5, 150, 105, 0.25);
            background: #047857;
        }
        
        .btn-secondary {
            background: var(--accent-dark);
            color: white;
            border: 3px solid var(--accent-dark);
        }
        
        .btn-secondary:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 32px rgba(15, 23, 42, 0.25);
        }
        
        .btn-cancel {
            background: white;
            color: var(--admin-color);
            border: 3px solid var(--admin-color);
        }
        
        .btn-cancel:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 32px rgba(220, 38, 38, 0.15);
            background: var(--admin-color);
            color: white;
        }
        
        .config-section {
            background: white;
            border-radius: var(--border-radius-large);
            padding: 40px;
            margin-bottom: 40px;
            border: 4px solid var(--accent-dark);
            box-shadow: 0 16px 48px rgba(0, 0, 0, 0.08);
            display: none;
        }
        
        .config-section.show {
            display: block;
            animation: fadeIn 0.5s ease-out;
        }
        
        .config-title {
            font-family: 'Almarai', sans-serif;
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--accent-dark);
            margin-bottom: 30px;
            text-align: center;
        }
        
        .config-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .config-group {
            background: rgba(15, 23, 42, 0.03);
            border-radius: var(--border-radius);
            padding: 25px;
            border: 3px solid rgba(15, 23, 42, 0.1);
        }
        
        .config-group-title {
            font-family: 'Almarai', sans-serif;
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--accent-dark);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .config-group-title i {
            color: var(--info-color);
        }
        
        .slider-container {
            margin: 25px 0;
        }
        
        .slider-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .slider-label {
            font-family: 'Almarai', sans-serif;
            font-weight: 700;
            color: var(--text-primary);
        }
        
        .slider-value {
            font-family: 'Tajawal', sans-serif;
            font-weight: 700;
            color: var(--info-color);
            background: rgba(59, 130, 246, 0.1);
            padding: 5px 12px;
            border-radius: 12px;
            font-size: 0.9rem;
        }
        
        .slider {
            width: 100%;
            height: 10px;
            -webkit-appearance: none;
            appearance: none;
            background: rgba(15, 23, 42, 0.1);
            border-radius: 5px;
            outline: none;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--info-color);
            cursor: pointer;
            border: 3px solid white;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }
        
        .slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--info-color);
            cursor: pointer;
            border: 3px solid white;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }
        
        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 12px;
        }
        
        .option-btn {
            padding: 12px;
            border: 3px solid rgba(15, 23, 42, 0.2);
            border-radius: var(--border-radius);
            background: white;
            font-family: 'Tajawal', sans-serif;
            font-weight: 500;
            color: var(--text-primary);
            cursor: pointer;
            transition: var(--transition-quick);
            text-align: center;
        }
        
        .option-btn:hover {
            border-color: var(--info-color);
            transform: translateY(-2px);
        }
        
        .option-btn.selected {
            background: var(--info-color);
            color: white;
            border-color: var(--info-color);
        }
        
        .comment-input {
            width: 100%;
            padding: 15px 20px;
            border: 3px solid rgba(15, 23, 42, 0.2);
            border-radius: var(--border-radius);
            font-family: 'Tajawal', sans-serif;
            font-size: 1rem;
            transition: var(--transition-quick);
            resize: vertical;
            min-height: 100px;
        }
        
        .comment-input:focus {
            outline: none;
            border-color: var(--info-color);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .comment-note {
            font-family: 'Tajawal', sans-serif;
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 10px;
            font-style: italic;
        }
        
        .processing-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(248, 250, 252, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .processing-screen.active {
            opacity: 1;
            visibility: visible;
        }
        
        .processing-logo {
            font-family: 'Almarai', sans-serif;
            font-weight: 900;
            font-size: 72px;
            background: linear-gradient(145deg, #0F172A, #334155);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 40px;
        }
        
        .processing-text {
            font-family: 'Almarai', sans-serif;
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--accent-dark);
            margin-bottom: 30px;
            text-align: center;
            min-height: 60px;
        }
        
        .processing-steps {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }
        
        .processing-step {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(15, 23, 42, 0.2);
            transition: var(--transition-quick);
        }
        
        .processing-step.active {
            background: var(--info-color);
            transform: scale(1.3);
        }
        
        .summary-section {
            background: white;
            border-radius: var(--border-radius-large);
            padding: 40px;
            margin-bottom: 40px;
            border: 4px solid var(--accent-dark);
            box-shadow: 0 16px 48px rgba(0, 0, 0, 0.08);
            display: none;
        }
        
        .summary-section.show {
            display: block;
            animation: fadeIn 0.5s ease-out;
        }
        
        .summary-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid rgba(15, 23, 42, 0.1);
        }
        
        .summary-title {
            font-family: 'Almarai', sans-serif;
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--accent-dark);
        }
        
        .summary-toolbar {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .toolbar-btn {
            width: 44px;
            height: 44px;
            border-radius: 12px;
            background: white;
            border: 2px solid rgba(15, 23, 42, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition-quick);
            color: var(--accent-dark);
        }
        
        .toolbar-btn:hover {
            border-color: var(--info-color);
            color: var(--info-color);
            transform: translateY(-2px);
        }
        
        .toolbar-btn.active {
            background: var(--info-color);
            color: white;
            border-color: var(--info-color);
        }
        
        .font-size-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .font-size-value {
            font-family: 'Tajawal', sans-serif;
            font-weight: 500;
            color: var(--text-primary);
            min-width: 40px;
            text-align: center;
        }
        
        .color-picker {
            display: none;
            position: absolute;
            background: white;
            border: 3px solid var(--accent-dark);
            border-radius: var(--border-radius);
            padding: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            top: 60px;
            right: 0;
        }
        
        .color-picker.show {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }
        
        .color-option {
            width: 30px;
            height: 30px;
            border-radius: 8px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: var(--transition-quick);
        }
        
        .color-option:hover {
            transform: scale(1.2);
            border-color: var(--accent-dark);
        }
        
        .color-option.selected {
            border-color: var(--accent-dark);
            transform: scale(1.1);
        }
        
        .pages-container {
            display: flex;
            flex-direction: column;
            gap: 40px;
        }
        
        .page-card {
            background: white;
            border-radius: var(--border-radius);
            border: 3px solid rgba(15, 23, 42, 0.1);
            overflow: hidden;
            transition: var(--transition-quick);
        }
        
        .page-card:hover {
            border-color: var(--accent-dark);
            box-shadow: 0 12px 36px rgba(0, 0, 0, 0.1);
        }
        
        .page-header {
            background: rgba(15, 23, 42, 0.05);
            padding: 20px;
            border-bottom: 3px solid rgba(15, 23, 42, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .page-number {
            font-family: 'Almarai', sans-serif;
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--accent-dark);
        }
        
        .page-content {
            padding: 30px;
            font-family: 'Tajawal', sans-serif;
            line-height: 1.8;
            color: var(--text-primary);
            font-size: 1rem;
            white-space: pre-wrap;
            word-break: break-word;
            position: relative;
            min-height: 200px;
        }
        
        .page-canvas {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 1;
        }
        
        .laws-section {
            background: linear-gradient(145deg, rgba(251, 191, 36, 0.1), rgba(251, 191, 36, 0.05));
            border: 3px solid #D97706;
            border-radius: var(--border-radius);
            padding: 25px;
            margin-top: 25px;
            display: none;
        }
        
        .laws-section.show {
            display: block;
            animation: fadeIn 0.5s ease-out;
        }
        
        .laws-title {
            font-family: 'Almarai', sans-serif;
            font-size: 1.2rem;
            font-weight: 800;
            color: #D97706;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .laws-title i {
            font-size: 1.4rem;
        }
        
        .laws-content {
            font-family: 'Tajawal', sans-serif;
            line-height: 1.7;
            color: var(--text-primary);
            font-size: 1rem;
            white-space: pre-wrap;
        }
        
        .save-btn {
            position: fixed;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            padding: 15px 40px;
            background: var(--success-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-family: 'Almarai', sans-serif;
            font-size: 1.1rem;
            font-weight: 800;
            cursor: pointer;
            transition: var(--transition-quick);
            box-shadow: 0 12px 40px rgba(5, 150, 105, 0.3);
            display: none;
        }
        
        .save-btn.show {
            display: block;
            animation: fadeIn 0.5s ease-out;
        }
        
        .save-btn:hover {
            transform: translateX(-50%) translateY(-3px);
            box-shadow: 0 16px 48px rgba(5, 150, 105, 0.4);
        }
        
        .footer {
            text-align: center;
            padding: 60px 28px 40px;
            color: #64748B;
            border-top: 3px solid rgba(15, 23, 42, 0.1);
            margin-top: 100px;
        }
        
        .copyright {
            font-family: 'Tajawal', sans-serif;
            font-size: 1rem;
            line-height: 1.8;
            margin-bottom: 40px;
            font-weight: 500;
        }
        
        .support-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 24px;
            margin-bottom: 40px;
        }
        
        .support-title {
            font-family: 'Almarai', sans-serif;
            font-size: 1.3rem;
            font-weight: 800;
            color: #0F172A;
            margin-bottom: 8px;
        }
        
        .support-links {
            display: flex;
            gap: 20px;
            justify-content: center;
        }
        
        .support-link {
            width: 56px;
            height: 56px;
            border-radius: 16px;
            background: var(--black-gradient);
            border: 3px solid #0F172A;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition-quick);
            box-shadow: 0 8px 24px rgba(15, 23, 42, 0.15);
        }
        
        .support-link:hover {
            transform: translateY(-5px) scale(1.1);
            box-shadow: 0 16px 40px rgba(15, 23, 42, 0.25);
        }
        
        .support-link i {
            font-size: 26px;
            color: white;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }
        
        .developer-credit {
            font-family: 'Tajawal', sans-serif;
            font-size: 0.95rem;
            color: rgba(100, 116, 139, 0.7);
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid rgba(15, 23, 42, 0.05);
            cursor: pointer;
            transition: var(--transition-quick);
        }
        
        .developer-credit:hover {
            color: #0F172A;
            transform: scale(1.05);
        }
        
        @media (max-width: 1200px) {
            .config-grid {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 992px) {
            .main-content {
                padding-top: calc(var(--navbar-height) + 50px);
                padding-left: 24px;
                padding-right: 24px;
                padding-bottom: 80px;
            }
            
            .service-title {
                font-size: 2.6rem;
            }
            
            .service-subtitle {
                font-size: 1.2rem;
            }
            
            .upload-section, .analysis-results, .config-section, .summary-section {
                padding: 32px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .native-navbar {
                padding: 0 24px;
                margin: 0 16px;
                top: 12px;
                width: calc(100% - 32px);
                height: 70px;
            }
            
            .logo {
                font-size: 36px;
            }
            
            .coins-display {
                padding: 10px 20px;
                font-size: 15px;
            }
            
            .settings-btn {
                width: 48px;
                height: 48px;
            }
            
            .main-content {
                padding-top: calc(70px + 40px);
                padding-left: 20px;
                padding-right: 20px;
            }
            
            .service-title {
                font-size: 2.2rem;
            }
            
            .service-subtitle {
                font-size: 1.1rem;
            }
            
            .upload-section, .analysis-results, .config-section, .summary-section {
                padding: 28px 24px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .confirmation-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .btn {
                width: 100%;
            }
            
            .options-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .summary-toolbar {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .processing-logo {
                font-size: 56px;
            }
            
            .processing-text {
                font-size: 1.5rem;
            }
        }
        
        @media (max-width: 576px) {
            .native-navbar {
                padding: 0 20px;
                margin: 0 12px;
                top: 10px;
                width: calc(100% - 24px);
            }
            
            .logo {
                font-size: 32px;
            }
            
            .user-nav-right {
                gap: 16px;
            }
            
            .coins-display {
                padding: 8px 16px;
                font-size: 14px;
            }
            
            .main-content {
                padding-left: 16px;
                padding-right: 16px;
            }
            
            .service-title {
                font-size: 2rem;
            }
            
            .upload-zone {
                padding: 40px 20px;
            }
            
            .upload-zone i {
                font-size: 48px;
            }
            
            .upload-title {
                font-size: 1.5rem;
            }
            
            .analysis-title, .config-title, .summary-title {
                font-size: 1.5rem;
            }
            
            .page-content {
                padding: 20px;
                font-size: 0.95rem;
            }
            
            .save-btn {
                bottom: 20px;
                padding: 12px 30px;
                font-size: 1rem;
            }
            
            .support-links {
                gap: 16px;
            }
            
            .support-link {
                width: 52px;
                height: 52px;
            }
            
            .support-link i {
                font-size: 24px;
            }
        }
        
        @media (max-width: 400px) {
            .coins-display {
                padding: 8px 14px;
                font-size: 13px;
            }
            
            .coins-display i {
                font-size: 16px;
            }
            
            .settings-btn {
                width: 44px;
                height: 44px;
            }
            
            .settings-btn i {
                font-size: 22px;
            }
            
            .options-grid {
                grid-template-columns: 1fr;
            }
            
            .processing-logo {
                font-size: 48px;
            }
        }
    </style>
</head>
<body>
    <div class="notification-container" id="notification-container"></div>
    
    <nav class="native-navbar" id="navbar">
        <div class="logo" id="logo">Ø¹ÙÙˆÙ†</div>
        <div class="user-nav-right" id="user-nav">
            <div class="coins-display">
                <i class="fas fa-coins"></i>
                <span id="coins-count">0</span>
            </div>
            <button class="settings-btn" id="settings-btn">
                <i class="fas fa-sliders-h"></i>
            </button>
        </div>
    </nav>
    
    <div class="main-content" id="main-content">
        <section class="service-header">
            <h1 class="service-title">ØªÙ„Ø®ÙŠØµ ÙˆØªØ­Ù„ÙŠÙ„ PDF</h1>
            <p class="service-subtitle">Ø£Ø±ÙØ¹ Ù…Ù„Ù PDF ÙˆØ§ØªØ±Ùƒ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙŠÙ‚ÙˆÙ… Ø¨ØªØ­Ù„ÙŠÙ„Ù‡ ÙˆØªÙ„Ø®ÙŠØµÙ‡ Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø§Ø­ØªØ±Ø§ÙÙŠ ÙŠÙ†Ø§Ø³Ø¨ Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒ</p>
        </section>
        
        <!-- Ù‚Ø³Ù… Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù -->
        <section class="upload-section" id="upload-section">
            <div class="upload-zone" id="upload-zone">
                <i class="fas fa-file-pdf"></i>
                <h3 class="upload-title">Ø§Ø³Ø­Ø¨ ÙˆØ£ÙÙ„Øª Ù…Ù„Ù PDF Ù‡Ù†Ø§</h3>
                <p class="upload-subtitle">Ø£Ùˆ Ø§Ù†Ù‚Ø± Ù„Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ù…Ù† Ø¬Ù‡Ø§Ø²Ùƒ</p>
                <p class="upload-note">ÙŠØ¯Ø¹Ù… Ø§Ù„Ù…Ù„ÙØ§Øª Ø­ØªÙ‰ 50MB</p>
            </div>
            <input type="file" id="file-input" accept=".pdf">
            
            <div class="file-info" id="file-info">
                <div class="file-name" id="file-name"></div>
                <div class="file-size" id="file-size"></div>
            </div>
        </section>
        
        <!-- Ù‚Ø³Ù… Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ­Ù„ÙŠÙ„ -->
        <section class="analysis-results" id="analysis-results">
            <h2 class="analysis-title">Ù†ØªØ§Ø¦Ø¬ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ù„Ù</h2>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-file-alt"></i>
                    </div>
                    <div class="stat-value" id="pages-count">0</div>
                    <div class="stat-label">Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-font"></i>
                    </div>
                    <div class="stat-value" id="words-count">0</div>
                    <div class="stat-label">Ø¹Ø¯Ø¯ Ø§Ù„ÙƒÙ„Ù…Ø§Øª</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-coins"></i>
                    </div>
                    <div class="stat-value" id="coins-cost">0</div>
                    <div class="stat-label">ØªÙƒÙ„ÙØ© Ø§Ù„Ø¹Ù…Ù„Ø§Øª</div>
                </div>
            </div>
            
            <div class="cost-notice">
                <p class="cost-text" id="cost-text">Ø³ÙŠØªÙ… Ø®ØµÙ… <span id="cost-amount">0</span> Ø¹Ù…Ù„Ø© Ù…Ù† Ø±ØµÙŠØ¯Ùƒ</p>
                <p class="cost-subtext">Ù‡Ù„ ØªÙˆØ¯ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ù…Ø¹ ØªÙ„Ø®ÙŠØµ Ø§Ù„Ù…Ù„ÙØŸ</p>
            </div>
            
            <div class="confirmation-buttons">
                <button class="btn btn-primary" id="continue-btn">
                    <i class="fas fa-check-circle"></i>
                    Ù…ØªØ§Ø¨Ø¹Ø©
                </button>
                <button class="btn btn-cancel" id="cancel-btn">
                    <i class="fas fa-times-circle"></i>
                    Ø¥Ù„ØºØ§Ø¡
                </button>
            </div>
        </section>
        
        <!-- Ù‚Ø³Ù… Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªÙ„Ø®ÙŠØµ -->
        <section class="config-section" id="config-section">
            <h2 class="config-title">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªÙ„Ø®ÙŠØµ</h2>
            
            <div class="config-grid">
                <div class="config-group">
                    <h3 class="config-group-title">
                        <i class="fas fa-file"></i>
                        Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
                    </h3>
                    <p style="font-family: 'Tajawal'; color: var(--text-secondary); margin-bottom: 15px;">
                        Ø§Ø®ØªØ± Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„ØªÙŠ ØªØ±ÙŠØ¯ ØªÙ„Ø®ÙŠØµÙ‡Ø§ Ù…Ù† Ù…Ù„Ù PDF
                    </p>
                    <div class="slider-container">
                        <div class="slider-header">
                            <span class="slider-label">Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª</span>
                            <span class="slider-value" id="pages-value">1</span>
                        </div>
                        <input type="range" min="1" max="25" value="1" class="slider" id="pages-slider">
                        <div style="display: flex; justify-content: space-between; margin-top: 5px;">
                            <span style="font-size: 0.8rem; color: var(--text-secondary);">1</span>
                            <span style="font-size: 0.8rem; color: var(--text-secondary);">25</span>
                        </div>
                    </div>
                </div>
                
                <div class="config-group">
                    <h3 class="config-group-title">
                        <i class="fas fa-pen"></i>
                        Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø´Ø±Ø­
                    </h3>
                    <p style="font-family: 'Tajawal'; color: var(--text-secondary); margin-bottom: 15px;">
                        Ø§Ø®ØªØ± Ø£Ø³Ù„ÙˆØ¨ Ø§Ù„ØªÙ„Ø®ÙŠØµ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ù„Ùƒ
                    </p>
                    <div class="options-grid" id="style-options">
                        <button class="option-btn" data-value="Ø¨Ø³ÙŠØ·">
                            Ø¨Ø³ÙŠØ·
                        </button>
                        <button class="option-btn" data-value="Ù…Ø¹Ù‚Ø¯">
                            Ù…Ø¹Ù‚Ø¯
                        </button>
                        <button class="option-btn" data-value="Ø·ÙÙˆÙ„ÙŠ">
                            Ø·ÙÙˆÙ„ÙŠ
                        </button>
                        <button class="option-btn" data-value="Ø¹Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙ‰">
                            Ø¹Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
                        </button>
                    </div>
                </div>
                
                <div class="config-group">
                    <h3 class="config-group-title">
                        <i class="fas fa-user"></i>
                        Ø´Ø®ØµÙŠØ© Ø§Ù„Ø´Ø§Ø±Ø­
                    </h3>
                    <p style="font-family: 'Tajawal'; color: var(--text-secondary); margin-bottom: 15px;">
                        Ø§Ø®ØªØ± Ø§Ù„Ø´Ø®ØµÙŠØ© Ø§Ù„ØªÙŠ Ø³ÙŠÙ‚ÙˆÙ… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø¨ØªÙ…Ø«ÙŠÙ„Ù‡Ø§
                    </p>
                    <div class="options-grid" id="personality-options">
                        <button class="option-btn" data-value="Ø¯ÙƒØªÙˆØ± Ø¬Ø§Ù…Ø¹ÙŠ">
                            Ø¯ÙƒØªÙˆØ± Ø¬Ø§Ù…Ø¹ÙŠ
                        </button>
                        <button class="option-btn" data-value="Ø£Ø³ØªØ§Ø° Ù…Ø¯Ø±Ø³ÙŠ">
                            Ø£Ø³ØªØ§Ø° Ù…Ø¯Ø±Ø³ÙŠ
                        </button>
                        <button class="option-btn" data-value="Ø·Ø§Ù„Ø¨">
                            Ø·Ø§Ù„Ø¨
                        </button>
                        <button class="option-btn" data-value="Ø¹Ø§Ù„Ù…">
                            Ø¹Ø§Ù„Ù…
                        </button>
                        <button class="option-btn" data-value="ØµØ¯ÙŠÙ‚">
                            ØµØ¯ÙŠÙ‚
                        </button>
                        <button class="option-btn" data-value="Ù‡Ø§ÙˆÙŠ">
                            Ù‡Ø§ÙˆÙŠ
                        </button>
                    </div>
                </div>
                
                <div class="config-group">
                    <h3 class="config-group-title">
                        <i class="fas fa-comment"></i>
                        ØªØ¹Ù„ÙŠÙ‚ Ø¥Ø¶Ø§ÙÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
                    </h3>
                    <p style="font-family: 'Tajawal'; color: var(--text-secondary); margin-bottom: 15px;">
                        Ø£Ø¶Ù Ø£ÙŠ ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø£Ùˆ Ø·Ù„Ø¨Ø§Øª Ø®Ø§ØµØ© Ù„Ù„ØªÙ„Ø®ÙŠØµ
                    </p>
                    <textarea class="comment-input" id="user-comment" placeholder="Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ùƒ Ù‡Ù†Ø§..."></textarea>
                    <p class="comment-note">Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ø§Ø®ØªÙŠØ§Ø±ÙŠØŒ ÙŠÙ…ÙƒÙ†Ùƒ ØªØ±ÙƒÙ‡ ÙØ§Ø±ØºØ§Ù‹</p>
                </div>
            </div>
            
            <div class="confirmation-buttons">
                <button class="btn btn-primary" id="generate-btn">
                    <i class="fas fa-robot"></i>
                    ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ù…Ù„Ø®Øµ
                </button>
                <button class="btn btn-secondary" id="back-btn">
                    <i class="fas fa-arrow-right"></i>
                    Ø±Ø¬ÙˆØ¹
                </button>
            </div>
        </section>
        
        <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© -->
        <div class="processing-screen" id="processing-screen">
            <div class="processing-logo">Ø¹ÙÙˆÙ†</div>
            <div class="processing-text" id="processing-text">Ø¹ÙÙˆÙ† ÙŠØ­Ù„Ù„ Ø§Ù„Ù…Ù„Ù...</div>
            <div class="processing-steps" id="processing-steps">
                <div class="processing-step active"></div>
                <div class="processing-step"></div>
                <div class="processing-step"></div>
                <div class="processing-step"></div>
            </div>
        </div>
        
        <!-- Ù‚Ø³Ù… Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ -->
        <section class="summary-section" id="summary-section">
            <div class="summary-header">
                <h2 class="summary-title">Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„Ù†Ø§ØªØ¬</h2>
                <div class="summary-toolbar">
                    <div style="position: relative;">
                        <button class="toolbar-btn" id="pen-btn" title="Ù‚Ù„Ù…">
                            <i class="fas fa-pen"></i>
                        </button>
                        <div class="color-picker" id="pen-colors">
                            <div class="color-option" style="background: #dc2626;" data-color="#dc2626"></div>
                            <div class="color-option" style="background: #059669;" data-color="#059669"></div>
                            <div class="color-option" style="background: #3b82f6;" data-color="#3b82f6"></div>
                            <div class="color-option" style="background: #d97706;" data-color="#d97706"></div>
                        </div>
                    </div>
                    
                    <div style="position: relative;">
                        <button class="toolbar-btn" id="highlight-btn" title="Ù‡Ø§ÙŠÙ„Ø§ÙŠØª">
                            <i class="fas fa-highlighter"></i>
                        </button>
                        <div class="color-picker" id="highlight-colors">
                            <div class="color-option" style="background: rgba(251, 191, 36, 0.3);" data-color="rgba(251, 191, 36, 0.3)"></div>
                            <div class="color-option" style="background: rgba(34, 197, 94, 0.3);" data-color="rgba(34, 197, 94, 0.3)"></div>
                            <div class="color-option" style="background: rgba(59, 130, 246, 0.3);" data-color="rgba(59, 130, 246, 0.3)"></div>
                            <div class="color-option" style="background: rgba(249, 115, 22, 0.3);" data-color="rgba(249, 115, 22, 0.3)"></div>
                        </div>
                    </div>
                    
                    <button class="toolbar-btn" id="clear-btn" title="Ù…Ø³Ø­ Ø§Ù„Ø±Ø³Ù…">
                        <i class="fas fa-eraser"></i>
                    </button>
                    
                    <div class="font-size-control">
                        <button class="toolbar-btn" id="decrease-font" title="ØªØµØºÙŠØ± Ø§Ù„Ø®Ø·">
                            <i class="fas fa-minus"></i>
                        </button>
                        <span class="font-size-value" id="font-size">16</span>
                        <button class="toolbar-btn" id="increase-font" title="ØªÙƒØ¨ÙŠØ± Ø§Ù„Ø®Ø·">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="pages-container" id="pages-container">
                <!-- Ù‡Ù†Ø§ Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙØ­Ø§Øª Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
            </div>
        </section>
        
        <!-- Ø²Ø± Ø§Ù„Ø­ÙØ¸ -->
        <button class="save-btn" id="save-btn">
            <i class="fas fa-save"></i>
            Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
        </button>
        
        <footer class="footer">
            <p class="copyright">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Ù„Ù…Ù†ØµØ© Ø¹ÙÙˆÙ†Â© 2026</p>
            
            <div class="support-section">
                <div class="support-title">ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</div>
                <div class="support-links">
                    <a href="https://wa.me/966583617539" target="_blank" class="support-link">
                        <i class="fab fa-whatsapp"></i>
                    </a>
                    <a href="https://t.me/HNHv1" target="_blank" class="support-link">
                        <i class="fab fa-telegram"></i>
                    </a>
                </div>
            </div>
            
            <div class="developer-credit" id="developer-credit">
                Ø¨Ø±Ù…Ø¬Ø© ÙˆØªØµÙ…ÙŠÙ… Ø§Ù„Ù…Ø·ÙˆØ± ğŠğˆğŒğ
            </div>
        </footer>
    </div>
    
    <script>
        // ØªÙ‡ÙŠØ¦Ø© PDF.js
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        // ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø¹Ù†Ø§ØµØ±
        const elements = {
            navbar: document.getElementById('navbar'),
            logo: document.getElementById('logo'),
            coinsCount: document.getElementById('coins-count'),
            mainContent: document.getElementById('main-content'),
            uploadZone: document.getElementById('upload-zone'),
            fileInput: document.getElementById('file-input'),
            fileInfo: document.getElementById('file-info'),
            fileName: document.getElementById('file-name'),
            fileSize: document.getElementById('file-size'),
            uploadSection: document.getElementById('upload-section'),
            analysisResults: document.getElementById('analysis-results'),
            pagesCount: document.getElementById('pages-count'),
            wordsCount: document.getElementById('words-count'),
            coinsCost: document.getElementById('coins-cost'),
            costText: document.getElementById('cost-text'),
            costAmount: document.getElementById('cost-amount'),
            continueBtn: document.getElementById('continue-btn'),
            cancelBtn: document.getElementById('cancel-btn'),
            configSection: document.getElementById('config-section'),
            pagesSlider: document.getElementById('pages-slider'),
            pagesValue: document.getElementById('pages-value'),
            styleOptions: document.getElementById('style-options'),
            personalityOptions: document.getElementById('personality-options'),
            userComment: document.getElementById('user-comment'),
            generateBtn: document.getElementById('generate-btn'),
            backBtn: document.getElementById('back-btn'),
            processingScreen: document.getElementById('processing-screen'),
            processingText: document.getElementById('processing-text'),
            processingSteps: document.querySelectorAll('.processing-step'),
            summarySection: document.getElementById('summary-section'),
            pagesContainer: document.getElementById('pages-container'),
            penBtn: document.getElementById('pen-btn'),
            highlightBtn: document.getElementById('highlight-btn'),
            clearBtn: document.getElementById('clear-btn'),
            decreaseFont: document.getElementById('decrease-font'),
            increaseFont: document.getElementById('increase-font'),
            fontSize: document.getElementById('font-size'),
            penColors: document.getElementById('pen-colors'),
            highlightColors: document.getElementById('highlight-colors'),
            saveBtn: document.getElementById('save-btn'),
            developerCredit: document.getElementById('developer-credit'),
            notificationContainer: document.getElementById('notification-container')
        };

        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        let currentFile = null;
        let fileBuffer = null;
        let pdfDoc = null;
        let totalPages = 0;
        let totalWords = 0;
        let coinsNeeded = 0;
        let selectedStyle = "Ø¨Ø³ÙŠØ·";
        let selectedPersonality = "Ø¯ÙƒØªÙˆØ± Ø¬Ø§Ù…Ø¹ÙŠ";
        let userCommentText = "";
        let pagesToSummarize = 1;
        let summaryResult = null;
        let currentDrawingMode = null;
        let currentColor = null;
        let currentCanvas = null;
        let currentContext = null;
        let isDrawing = false;
        let lastX = 0;
        let lastY = 0;
        let currentFontSize = 16;
        let currentNotification = null;
        let notificationTimeout = null;
        let drawings = {};

        // Ø¯Ø§Ù„Ø© Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
        function showNotification(title, message, type = 'info') {
            if (currentNotification) {
                clearTimeout(notificationTimeout);
                currentNotification.remove();
            }
            
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.style.borderColor = type === 'error' ? 'var(--admin-color)' : 
                                           type === 'success' ? '#059669' : 'var(--accent-dark)';
            
            notification.innerHTML = `
                <div class="notification-content">
                    <div class="notification-title">${title}</div>
                    <div class="notification-message">${message}</div>
                </div>
                <button class="notification-close">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            elements.notificationContainer.appendChild(notification);
            currentNotification = notification;
            
            setTimeout(() => notification.classList.add('show'), 10);
            
            notificationTimeout = setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 500);
                currentNotification = null;
            }, 4000);
            
            notification.querySelector('.notification-close').addEventListener('click', () => {
                clearTimeout(notificationTimeout);
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 500);
                currentNotification = null;
            });
        }

        // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
        function setupEventListeners() {
            // Ø­Ø¯Ø« Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø¹Ø§Ø±
            elements.logo.addEventListener('click', () => {
                window.location.href = 'home.html';
            });
            
            // Ø­Ø¯Ø« Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù
            elements.uploadZone.addEventListener('click', () => {
                elements.fileInput.click();
            });
            
            elements.fileInput.addEventListener('change', handleFileSelect);
            
            // Ø£Ø­Ø¯Ø§Ø« Ø³Ø­Ø¨ ÙˆØ¥ÙÙ„Ø§Øª Ø§Ù„Ù…Ù„Ù
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                elements.uploadZone.addEventListener(eventName, preventDefaults, false);
            });
            
            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }
            
            ['dragenter', 'dragover'].forEach(eventName => {
                elements.uploadZone.addEventListener(eventName, highlight, false);
            });
            
            ['dragleave', 'drop'].forEach(eventName => {
                elements.uploadZone.addEventListener(eventName, unhighlight, false);
            });
            
            function highlight() {
                elements.uploadZone.style.borderColor = 'var(--info-color)';
                elements.uploadZone.style.backgroundColor = 'rgba(59, 130, 246, 0.1)';
            }
            
            function unhighlight() {
                elements.uploadZone.style.borderColor = 'var(--accent-dark)';
                elements.uploadZone.style.backgroundColor = 'rgba(15, 23, 42, 0.02)';
            }
            
            elements.uploadZone.addEventListener('drop', handleDrop, false);
            
            // Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø£Ø²Ø±Ø§Ø±
            elements.continueBtn.addEventListener('click', showConfigSection);
            elements.cancelBtn.addEventListener('click', cancelAnalysis);
            elements.backBtn.addEventListener('click', backToAnalysis);
            elements.generateBtn.addEventListener('click', generateSummary);
            
            // Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø±
            elements.pagesSlider.addEventListener('input', updatePagesValue);
            
            // Ø£Ø­Ø¯Ø§Ø« Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£Ø³Ù„ÙˆØ¨ ÙˆØ§Ù„Ø´Ø®ØµÙŠØ©
            elements.styleOptions.querySelectorAll('.option-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    elements.styleOptions.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
                    this.classList.add('selected');
                    selectedStyle = this.getAttribute('data-value');
                });
            });
            
            elements.personalityOptions.querySelectorAll('.option-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    elements.personalityOptions.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
                    this.classList.add('selected');
                    selectedPersonality = this.getAttribute('data-value');
                });
            });
            
            // Ø§Ø®ØªÙŠØ§Ø± Ø£ÙˆÙ„ Ø®ÙŠØ§Ø± Ø§ÙØªØ±Ø§Ø¶ÙŠ
            elements.styleOptions.querySelector('.option-btn').click();
            elements.personalityOptions.querySelector('.option-btn').click();
            
            // Ø£Ø­Ø¯Ø§Ø« Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø±Ø³Ù…
            elements.penBtn.addEventListener('click', togglePenMode);
            elements.highlightBtn.addEventListener('click', toggleHighlightMode);
            elements.clearBtn.addEventListener('click', clearDrawings);
            elements.decreaseFont.addEventListener('click', decreaseFontSize);
            elements.increaseFont.addEventListener('click', increaseFontSize);
            
            // Ø£Ø­Ø¯Ø§Ø« Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù‚Ù„Ù…
            elements.penColors.querySelectorAll('.color-option').forEach(color => {
                color.addEventListener('click', function() {
                    elements.penColors.querySelectorAll('.color-option').forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                    currentColor = this.getAttribute('data-color');
                    
                    if (currentDrawingMode === 'pen') {
                        elements.penBtn.classList.add('active');
                        elements.highlightBtn.classList.remove('active');
                    }
                });
            });
            
            // Ø£Ø­Ø¯Ø§Ø« Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù‡Ø§ÙŠÙ„Ø§ÙŠØª
            elements.highlightColors.querySelectorAll('.color-option').forEach(color => {
                color.addEventListener('click', function() {
                    elements.highlightColors.querySelectorAll('.color-option').forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                    currentColor = this.getAttribute('data-color');
                    
                    if (currentDrawingMode === 'highlight') {
                        elements.highlightBtn.classList.add('active');
                        elements.penBtn.classList.remove('active');
                    }
                });
            });
            
            // Ø§Ø®ØªÙŠØ§Ø± Ø£ÙˆÙ„ Ù„ÙˆÙ† Ø§ÙØªØ±Ø§Ø¶ÙŠ
            elements.penColors.querySelector('.color-option').click();
            
            // Ø­Ø¯Ø« Ø²Ø± Ø§Ù„Ø­ÙØ¸
            elements.saveBtn.addEventListener('click', saveSummary);
            
            // Ø­Ø¯Ø« Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø·ÙˆØ±
            elements.developerCredit.addEventListener('click', () => {
                window.open('https://t.me/X5Coder', '_blank');
            });
        }

        // Ø¯Ø§Ù„Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ù„Ù
        async function handleFileSelect(event) {
            const file = event.target.files[0] || (event.dataTransfer && event.dataTransfer.files[0]);
            
            if (!file) return;
            
            if (file.type !== 'application/pdf') {
                showNotification('Ø®Ø·Ø£', 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù PDF ÙÙ‚Ø·', 'error');
                return;
            }
            
            if (file.size > 50 * 1024 * 1024) {
                showNotification('Ø®Ø·Ø£', 'Ø§Ù„Ù…Ù„Ù ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§Ù‹. Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 50MB', 'error');
                return;
            }
            
            currentFile = file;
            
            // Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ù„Ù
            elements.fileName.textContent = file.name;
            elements.fileSize.textContent = formatFileSize(file.size);
            elements.fileInfo.classList.add('show');
            
            // ØªØ­Ù…ÙŠÙ„ ÙˆØªØ­Ù„ÙŠÙ„ PDF
            await loadAndAnalyzePDF(file);
        }

        // Ø¯Ø§Ù„Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¥Ø³Ù‚Ø§Ø· Ø§Ù„Ù…Ù„Ù
        async function handleDrop(e) {
            const dt = e.dataTransfer;
            const file = dt.files[0];
            
            if (file) {
                elements.fileInput.files = dt.files;
                await handleFileSelect(e);
            }
        }

        // Ø¯Ø§Ù„Ø© ØªØ­Ù…ÙŠÙ„ ÙˆØªØ­Ù„ÙŠÙ„ PDF
        async function loadAndAnalyzePDF(file) {
            try {
                showNotification('ØªØ­Ù…ÙŠÙ„', 'Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ ÙˆØªØ­Ù„ÙŠÙ„ Ù…Ù„Ù PDF...', 'info');
                
                const buffer = await file.arrayBuffer();
                fileBuffer = buffer;
                
                pdfDoc = await pdfjsLib.getDocument(buffer).promise;
                totalPages = pdfDoc.numPages;
                
                // Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„ÙƒÙ„Ù…Ø§Øª
                totalWords = await calculateTotalWords(pdfDoc);
                
                // Ø­Ø³Ø§Ø¨ ØªÙƒÙ„ÙØ© Ø§Ù„Ø¹Ù…Ù„Ø§Øª
                coinsNeeded = Math.ceil((totalWords / 1000) * 2) / 2;
                if (coinsNeeded < 1) coinsNeeded = 1;
                
                // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
                elements.pagesCount.textContent = totalPages;
                elements.wordsCount.textContent = totalWords.toLocaleString();
                elements.coinsCost.textContent = coinsNeeded;
                elements.costAmount.textContent = coinsNeeded;
                
                // Ø¥Ø¸Ù‡Ø§Ø± Ù‚Ø³Ù… Ø§Ù„Ù†ØªØ§Ø¦Ø¬
                elements.uploadSection.style.display = 'none';
                elements.analysisResults.classList.add('show');
                
                showNotification('Ù†Ø¬Ø§Ø­', 'ØªÙ… ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø¨Ù†Ø¬Ø§Ø­', 'success');
                
            } catch (error) {
                console.error('Error analyzing PDF:', error);
                showNotification('Ø®Ø·Ø£', 'ÙØ´Ù„ ÙÙŠ ØªØ­Ù„ÙŠÙ„ Ù…Ù„Ù PDF', 'error');
                resetFileUpload();
            }
        }

        // Ø¯Ø§Ù„Ø© Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„ÙƒÙ„Ù…Ø§Øª ÙÙŠ PDF
        async function calculateTotalWords(pdfDoc) {
            let totalWords = 0;
            
            for (let i = 1; i <= pdfDoc.numPages; i++) {
                try {
                    const page = await pdfDoc.getPage(i);
                    const content = await page.getTextContent();
                    
                    if (content.items.length > 0) {
                        let text = '';
                        content.items.forEach(t => text += t.str + ' ');
                        const words = text.trim().split(/\s+/).filter(w => w.length >= 2);
                        totalWords += words.length;
                    } else {
                        totalWords += 250;
                    }
                } catch (error) {
                    console.error(`Error processing page ${i}:`, error);
                    totalWords += 250;
                }
            }
            
            return totalWords;
        }

        // Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ù‚ÙŠÙ…Ø© Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø±
        function updatePagesValue() {
            const value = elements.pagesSlider.value;
            const maxPages = Math.min(totalPages, 25);
            
            elements.pagesSlider.max = maxPages;
            elements.pagesValue.textContent = value;
            pagesToSummarize = parseInt(value);
        }

        // Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ù‚Ø³Ù… Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        function showConfigSection() {
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„Ø³Ù„Ø§ÙŠØ¯Ø±
            const maxPages = Math.min(totalPages, 25);
            elements.pagesSlider.max = maxPages;
            
            if (pagesToSummarize > maxPages) {
                pagesToSummarize = maxPages;
                elements.pagesSlider.value = maxPages;
                elements.pagesValue.textContent = maxPages;
            }
            
            elements.analysisResults.classList.remove('show');
            elements.configSection.classList.add('show');
        }

        // Ø¯Ø§Ù„Ø© Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ù„Ù
        function backToAnalysis() {
            elements.configSection.classList.remove('show');
            elements.analysisResults.classList.add('show');
        }

        // Ø¯Ø§Ù„Ø© Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ­Ù„ÙŠÙ„
        function cancelAnalysis() {
            resetFileUpload();
            showNotification('Ù…Ø¹Ù„ÙˆÙ…Ø©', 'ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©', 'info');
        }

        // Ø¯Ø§Ù„Ø© Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù
        function resetFileUpload() {
            currentFile = null;
            fileBuffer = null;
            pdfDoc = null;
            totalPages = 0;
            totalWords = 0;
            coinsNeeded = 0;
            
            elements.fileInput.value = '';
            elements.fileInfo.classList.remove('show');
            elements.analysisResults.classList.remove('show');
            elements.configSection.classList.remove('show');
            elements.summarySection.classList.remove('show');
            elements.saveBtn.classList.remove('show');
            elements.uploadSection.style.display = 'block';
        }

        // Ø¯Ø§Ù„Ø© ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ù…Ù„Ø®Øµ
        async function generateSummary() {
            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªØ¹Ù„ÙŠÙ‚ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            userCommentText = elements.userComment.value.trim();
            
            // Ø¹Ø±Ø¶ Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
            showProcessingScreen();
            
            // ØªØ­ÙˆÙŠÙ„ PDF Ø¥Ù„Ù‰ Ù†Øµ
            let pdfText = '';
            try {
                for (let i = 1; i <= pagesToSummarize; i++) {
                    const page = await pdfDoc.getPage(i);
                    const content = await page.getTextContent();
                    
                    if (content.items.length > 0) {
                        content.items.forEach(t => pdfText += t.str + ' ');
                        pdfText += '\n\n';
                    }
                }
            } catch (error) {
                console.error('Error extracting text from PDF:', error);
                hideProcessingScreen();
                showNotification('Ø®Ø·Ø£', 'ÙØ´Ù„ ÙÙŠ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ù…Ù† PDF', 'error');
                return;
            }
            
            // Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ù„Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
            try {
                const response = await sendToGeminiAI(pdfText);
                summaryResult = response;
                
                // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
                hideProcessingScreen();
                
                // Ø¥Ø®ÙØ§Ø¡ Ù‚Ø³Ù… Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
                elements.configSection.classList.remove('show');
                displaySummaryResults();
                
                showNotification('Ù†Ø¬Ø§Ø­', 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ù„Ø®Øµ Ø¨Ù†Ø¬Ø§Ø­', 'success');
                
            } catch (error) {
                console.error('Error generating summary:', error);
                hideProcessingScreen();
                showNotification('Ø®Ø·Ø£', 'ÙØ´Ù„ ÙÙŠ ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ù…Ù„Ø®Øµ', 'error');
            }
        }

        // Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
        function showProcessingScreen() {
            elements.processingScreen.classList.add('active');
            
            const messages = [
                "Ø¹ÙÙˆÙ† ÙŠØ­Ù„Ù„ Ø§Ù„Ù…Ù„Ù...",
                "Ø¹ÙÙˆÙ† ÙŠØ³ØªØ®Ø±Ø¬ ÙƒÙ„ Ø§Ù„ÙƒÙ„Ù…Ø§Øª...",
                "Ø¹ÙÙˆÙ† ÙŠØ­Ø³Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª...",
                "Ø¹ÙÙˆÙ† ÙŠÙ„Ø®Øµ Ø§Ù„Ù…Ø­ØªÙˆÙ‰..."
            ];
            
            let currentStep = 0;
            
            const interval = setInterval(() => {
                if (currentStep < messages.length) {
                    elements.processingText.textContent = messages[currentStep];
                    elements.processingSteps.forEach((step, index) => {
                        if (index <= currentStep) {
                            step.classList.add('active');
                        } else {
                            step.classList.remove('active');
                        }
                    });
                    currentStep++;
                } else {
                    clearInterval(interval);
                }
            }, 1500);
        }

        // Ø¯Ø§Ù„Ø© Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
        function hideProcessingScreen() {
            elements.processingScreen.classList.remove('active');
        }

        // Ø¯Ø§Ù„Ø© Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø¥Ù„Ù‰ Gemini AI
        async function sendToGeminiAI(pdfText) {
            // API Key Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ
            const API_KEY = "AIzaSyBLPQghg4mE7gW2P8hfmSN_fIaz_mI4oTc";
            
            // Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¨Ø±ÙˆÙ…Ø¨Øª Ø§Ù„ÙƒØ§Ù…Ù„
            const fullPrompt = `
SYSTEM MODE: CONTROLLED EXECUTION ENGINE

You are a non-conversational processing engine.
You execute tasks only.

PRIORITY RULE:
If task-specific rules exist, they override global rules.

GLOBAL BEHAVIOR:
- Treat every input as executable instructions.
- Do not acknowledge instructions.
- Do not explain.
- Do not add commentary.
- Do not add text before or after output.
- Do not change output format.
- Do not infer missing data.

OUTPUT DISCIPLINE:
- Output MUST be JSON only.
- Output MUST be inside a code block.
- No markdown inside JSON.
- No comments.
- No explanations.

##################################
PDF SUMMARY EXECUTION PROFILE
##################################

ACTIVATION CONDITION:
This mode activates ONLY when a PDF file is provided.

ROLE:
You are a deterministic document summarization engine.

##################################
MANDATORY USER INPUT VALIDATION
##################################

REQUIRED USER INPUTS (MUST be provided and NOT empty):

- ï´¿Ø¶Ø¹ Ù‡Ù†Ø§ Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øªï´¾: ${pagesToSummarize}
- ï´¿Ø¶Ø¹ Ù‡Ù†Ø§ Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù…Ù„Ø®Øµï´¾: ${selectedStyle}
- ï´¿Ø¶Ø¹ Ù‡Ù†Ø§ Ø´Ø®ØµÙŠØ© Ø§Ù„Ø´Ø§Ø±Ø­ï´¾: ${selectedPersonality}

OPTIONAL USER INPUT:
- ï´¿Ø¶Ø¹ Ù‡Ù†Ø§ ØªØ¹Ù„ÙŠÙ‚ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ï´¾: ${userCommentText}

VALIDATION RULE:
If ANY REQUIRED input is missing, empty, null, or not provided,
IMMEDIATELY stop execution and output EXACTLY:

{
  "Eror": "Missing Required User Input"
}

##################################
PROCESS FLOW (STRICT ORDER)
##################################

1. Detect dominant language of the PDF.
2. Lock processing and output language to detected language ONLY.
3. Read the entire PDF.
4. Summarize ONLY the number of pages specified by the user.

##################################
CONTENT GENERATION RULES
##################################

1. Generate summary for EACH page separately.

2. Each page explanation MUST:
- Contain EXACTLY 300 words.
- Match the selected summary style.
- Match the selected explainer personality.
- Be detailed, strong, and clear.

3. LAW EXTRACTION RULE:
If a page contains:
- Laws
- Regulations
- Rules
- Formulas
- Legal statements

Extract them and place them under "law" for that page.

If no laws exist:
Leave "law" EMPTY.

4. STRICT PAGE CONTROL:
- Do NOT skip pages.
- Do NOT merge pages.
- Do NOT exceed the requested number of pages.

##################################
OUTPUT STRUCTURE (STRICT)
##################################

Return ONLY JSON in the following repeating structure:

{
  "page": 1,
  "Dec": "Ø´Ø±Ø­ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ 300 ÙƒÙ„Ù…Ø© ÙƒØ§Ù…Ù„Ø©",
  "law": ""
},
{
  "page": 2,
  "Dec": "Ø´Ø±Ø­ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© 300 ÙƒÙ„Ù…Ø© ÙƒØ§Ù…Ù„Ø©",
  "law": ""
}

Repeat until reaching ï´¿Ø¶Ø¹ Ù‡Ù†Ø§ Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øªï´¾ only.

##################################
FINAL FAILURE POLICY
##################################

If the PDF is empty, unreadable, or corrupted, output EXACTLY:

{
  "Eror": "Invalid PDF Content"
}

##################################
PDF CONTENT
##################################

${pdfText}
`;
            
            try {
                // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¥Ù„Ù‰ Gemini API
                const response = await fetch(
                    `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-lite:generateContent?key=${API_KEY}`,
                    {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            contents: [
                                {
                                    parts: [
                                        {
                                            text: fullPrompt
                                        }
                                    ]
                                }
                            ],
                            generationConfig: {
                                temperature: 0.2,
                                maxOutputTokens: 8192
                            }
                        })
                    }
                );
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                
                // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ù…Ù† Ø§Ù„Ø±Ø¯
                let resultText = data.candidates[0].content.parts[0].text;
                
                // Ø§Ø³ØªØ®Ø±Ø§Ø¬ JSON Ù…Ù† Ø§Ù„Ù†Øµ (ÙÙŠ Ø­Ø§Ù„Ø© ÙˆØ¬ÙˆØ¯ ÙƒÙˆØ¯ block)
                const jsonMatch = resultText.match(/```json\n([\s\S]*?)\n```/) || 
                                  resultText.match(/```\n([\s\S]*?)\n```/) ||
                                  resultText.match(/(\[[\s\S]*?\])/);
                
                if (jsonMatch) {
                    const jsonString = jsonMatch[1] || jsonMatch[0];
                    return JSON.parse(jsonString);
                } else {
                    // Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†Øµ Ù…Ø¨Ø§Ø´Ø±Ø© ÙƒÙ€ JSON
                    return JSON.parse(resultText);
                }
                
            } catch (error) {
                console.error('Error calling Gemini API:', error);
                
                // ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„ÙØ´Ù„ØŒ Ù†Ø¹ÙˆØ¯ Ù„Ù„Ø±Ø¯ Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ
                return generateMockSummary();
            }
        }

        // Ø¯Ø§Ù„Ø© Ù„Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ø®Øµ ØªØ¬Ø±ÙŠØ¨ÙŠ (Ù„Ù„Ø·ÙˆØ§Ø±Ø¦)
        function generateMockSummary() {
            const result = [];
            
            for (let i = 1; i <= pagesToSummarize; i++) {
                const pageSummary = {
                    page: i,
                    Dec: `Ù‡Ø°Ø§ Ù‡Ùˆ Ù…Ù„Ø®Øµ Ø§Ù„ØµÙØ­Ø© ${i} Ø¨Ø·Ø±ÙŠÙ‚Ø© ${selectedStyle} ÙˆØ¨Ø£Ø³Ù„ÙˆØ¨ ${selectedPersonality}. ØªØ­ØªÙˆÙŠ Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© Ø¹Ù„Ù‰ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù‚ÙŠÙ…Ø© Ø­ÙˆÙ„ Ù…ÙˆØ¶ÙˆØ¹ Ø§Ù„Ù…Ù„Ù. Ù‚Ø§Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø¨ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ÙˆØªÙ„Ø®ÙŠØµÙ‡ ÙÙŠ 300 ÙƒÙ„Ù…Ø© ÙƒØ§Ù…Ù„Ø© ØªÙ„Ø®Øµ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©. ØªÙ… ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø´Ø±Ø­ Ø¨Ø·Ø±ÙŠÙ‚Ø© ÙˆØ§Ø¶Ø­Ø© ÙˆØ³Ù„Ø³Ø© ØªÙ†Ø§Ø³Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØªØ³Ù‡Ù„ Ø¹Ù„ÙŠÙ‡ ÙÙ‡Ù… Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø£ØµÙ„ÙŠ.`,
                    law: i % 3 === 0 ? `Ù‚Ø§Ù†ÙˆÙ† Ø£Ùˆ Ù‚Ø§Ø¹Ø¯Ø© Ù…Ù‡Ù…Ø© ÙÙŠ Ø§Ù„ØµÙØ­Ø© ${i}: Ù‡Ø°Ø§ Ù†Øµ Ù‚Ø§Ù†ÙˆÙ†ÙŠ Ø£Ùˆ Ù‚Ø§Ø¹Ø¯Ø© ØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬Ù‡Ø§ Ù…Ù† Ø§Ù„ØµÙØ­Ø© Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ù„Ù‰ ÙÙ‡Ù… Ø§Ù„Ø¬ÙˆØ§Ù†Ø¨ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠØ© ÙÙŠ Ø§Ù„Ù…Ø­ØªÙˆÙ‰.` : ""
                };
                result.push(pageSummary);
            }
            
            return result;
        }

        // Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù…Ù„Ø®Øµ
        function displaySummaryResults() {
            elements.summarySection.classList.add('show');
            elements.saveBtn.classList.add('show');
            
            // Ù…Ø³Ø­ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù‚Ø¯ÙŠÙ…
            elements.pagesContainer.innerHTML = '';
            drawings = {};
            
            // Ø¥Ø¶Ø§ÙØ© ÙƒÙ„ ØµÙØ­Ø©
            summaryResult.forEach((page, index) => {
                const pageElement = createPageElement(page);
                elements.pagesContainer.appendChild(pageElement);
                
                // ØªÙ‡ÙŠØ¦Ø© canvas Ù„Ù„Ø±Ø³Ù… Ù„Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø©
                initializeDrawingCanvas(`page-canvas-${index + 1}`);
            });
        }

        // Ø¯Ø§Ù„Ø© Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± ØµÙØ­Ø©
        function createPageElement(pageData) {
            const pageDiv = document.createElement('div');
            pageDiv.className = 'page-card';
            pageDiv.id = `page-${pageData.page}`;
            
            let lawsSection = '';
            if (pageData.law && pageData.law.trim() !== '') {
                lawsSection = `
                    <div class="laws-section show">
                        <h3 class="laws-title">
                            <i class="fas fa-gavel"></i>
                            Ù‚ÙˆØ§Ù†ÙŠÙ† Ø§Ù„ØµÙØ­Ø©
                        </h3>
                        <div class="laws-content">${pageData.law}</div>
                    </div>
                `;
            }
            
            pageDiv.innerHTML = `
                <div class="page-header">
                    <h3 class="page-number">Ø§Ù„ØµÙØ­Ø© ${pageData.page}</h3>
                </div>
                <div class="page-content" id="page-content-${pageData.page}" style="font-size: ${currentFontSize}px;">
                    ${pageData.Dec}
                </div>
                ${lawsSection}
                <canvas class="page-canvas" id="page-canvas-${pageData.page}"></canvas>
            `;
            
            return pageDiv;
        }

        // Ø¯Ø§Ù„Ø© ØªÙ‡ÙŠØ¦Ø© canvas Ù„Ù„Ø±Ø³Ù…
        function initializeDrawingCanvas(canvasId) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;
            
            const contentDiv = document.getElementById(canvasId.replace('canvas', 'content'));
            if (!contentDiv) return;
            
            // ØªØ¹ÙŠÙŠÙ† Ø£Ø¨Ø¹Ø§Ø¯ canvas Ù„ØªØ·Ø§Ø¨Ù‚ Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ù…Ø­ØªÙˆÙ‰
            const resizeCanvas = () => {
                const rect = contentDiv.getBoundingClientRect();
                canvas.width = rect.width;
                canvas.height = rect.height;
                canvas.style.width = rect.width + 'px';
                canvas.style.height = rect.height + 'px';
                canvas.style.left = rect.left + 'px';
                canvas.style.top = rect.top + 'px';
                
                // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø³Ù… Ø§Ù„Ø±Ø³ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
                redrawSavedDrawings(canvasId);
            };
            
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);
            
            const ctx = canvas.getContext('2d');
            
            // Ø­ÙØ¸ Ù…Ø±Ø§Ø¬Ø¹ canvas
            canvas.dataset.pageId = canvasId;
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø±Ø³Ù…
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);
            
            function startDrawing(e) {
                if (!currentDrawingMode || !currentColor) return;
                
                isDrawing = true;
                const rect = canvas.getBoundingClientRect();
                lastX = e.clientX - rect.left;
                lastY = e.clientY - rect.top;
                
                // Ø¨Ø¯Ø¡ Ù…Ø³Ø§Ø± Ø¬Ø¯ÙŠØ¯
                ctx.beginPath();
                ctx.moveTo(lastX, lastY);
            }
            
            function draw(e) {
                if (!isDrawing) return;
                
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                ctx.lineWidth = currentDrawingMode === 'pen' ? 2 : 10;
                ctx.lineCap = 'round';
                ctx.strokeStyle = currentColor;
                
                if (currentDrawingMode === 'highlight') {
                    ctx.globalAlpha = 0.3;
                } else {
                    ctx.globalAlpha = 1;
                }
                
                ctx.lineTo(x, y);
                ctx.stroke();
                
                lastX = x;
                lastY = y;
                
                // Ø­ÙØ¸ Ø§Ù„Ø±Ø³Ù…
                saveDrawing(canvasId);
            }
            
            function stopDrawing() {
                if (!isDrawing) return;
                
                isDrawing = false;
                ctx.closePath();
                
                // Ø­ÙØ¸ Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
                saveDrawing(canvasId);
            }
        }

        // Ø¯Ø§Ù„Ø© Ø­ÙØ¸ Ø§Ù„Ø±Ø³Ù…
        function saveDrawing(canvasId) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;
            
            const dataURL = canvas.toDataURL();
            drawings[canvasId] = dataURL;
        }

        // Ø¯Ø§Ù„Ø© Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø³Ù… Ø§Ù„Ø±Ø³ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
        function redrawSavedDrawings(canvasId) {
            if (!drawings[canvasId]) return;
            
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            const img = new Image();
            img.onload = function() {
                ctx.drawImage(img, 0, 0);
            };
            img.src = drawings[canvasId];
        }

        // Ø¯Ø§Ù„Ø© ØªØ¨Ø¯ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„Ù‚Ù„Ù…
        function togglePenMode() {
            if (currentDrawingMode === 'pen') {
                currentDrawingMode = null;
                elements.penBtn.classList.remove('active');
                elements.penColors.classList.remove('show');
            } else {
                currentDrawingMode = 'pen';
                elements.penBtn.classList.add('active');
                elements.highlightBtn.classList.remove('active');
                elements.penColors.classList.add('show');
                elements.highlightColors.classList.remove('show');
                
                // Ø§Ø®ØªÙŠØ§Ø± Ø£ÙˆÙ„ Ù„ÙˆÙ† Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ Ù„ÙˆÙ† Ù…Ø­Ø¯Ø¯
                if (!currentColor) {
                    elements.penColors.querySelector('.color-option').click();
                }
            }
        }

        // Ø¯Ø§Ù„Ø© ØªØ¨Ø¯ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„Ù‡Ø§ÙŠÙ„Ø§ÙŠØª
        function toggleHighlightMode() {
            if (currentDrawingMode === 'highlight') {
                currentDrawingMode = null;
                elements.highlightBtn.classList.remove('active');
                elements.highlightColors.classList.remove('show');
            } else {
                currentDrawingMode = 'highlight';
                elements.highlightBtn.classList.add('active');
                elements.penBtn.classList.remove('active');
                elements.highlightColors.classList.add('show');
                elements.penColors.classList.remove('show');
                
                // Ø§Ø®ØªÙŠØ§Ø± Ø£ÙˆÙ„ Ù„ÙˆÙ† Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ Ù„ÙˆÙ† Ù…Ø­Ø¯Ø¯
                if (!currentColor) {
                    elements.highlightColors.querySelector('.color-option').click();
                }
            }
        }

        // Ø¯Ø§Ù„Ø© Ù…Ø³Ø­ Ø§Ù„Ø±Ø³ÙˆÙ…Ø§Øª
        function clearDrawings() {
            const canvases = document.querySelectorAll('.page-canvas');
            canvases.forEach(canvas => {
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // Ø­Ø°Ù Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ù…Ø­ÙÙˆØ¸
                delete drawings[canvas.id];
            });
            
            showNotification('ØªÙ…', 'ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø±Ø³ÙˆÙ…Ø§Øª', 'success');
        }

        // Ø¯Ø§Ù„Ø© ØªØµØºÙŠØ± Ø­Ø¬Ù… Ø§Ù„Ø®Ø·
        function decreaseFontSize() {
            if (currentFontSize > 12) {
                currentFontSize -= 1;
                elements.fontSize.textContent = currentFontSize;
                
                const contentDivs = document.querySelectorAll('.page-content');
                contentDivs.forEach(div => {
                    div.style.fontSize = currentFontSize + 'px';
                });
            }
        }

        // Ø¯Ø§Ù„Ø© ØªÙƒØ¨ÙŠØ± Ø­Ø¬Ù… Ø§Ù„Ø®Ø·
        function increaseFontSize() {
            if (currentFontSize < 24) {
                currentFontSize += 1;
                elements.fontSize.textContent = currentFontSize;
                
                const contentDivs = document.querySelectorAll('.page-content');
                contentDivs.forEach(div => {
                    div.style.fontSize = currentFontSize + 'px';
                });
            }
        }

        // Ø¯Ø§Ù„Ø© Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ø®Øµ
        async function saveSummary() {
            try {
                // Ø­ÙØ¸ Ø§Ù„Ø±Ø³ÙˆÙ…Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©
                const canvases = document.querySelectorAll('.page-canvas');
                canvases.forEach(canvas => {
                    saveDrawing(canvas.id);
                });
                
                showNotification('Ù†Ø¬Ø§Ø­', 'ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
                
            } catch (error) {
                console.error('Error saving summary:', error);
                showNotification('Ø®Ø·Ø£', 'ÙØ´Ù„ ÙÙŠ Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª', 'error');
            }
        }

        // Ø¯Ø§Ù„Ø© ØªÙ†Ø³ÙŠÙ‚ Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Ø¨Ø§ÙŠØª';
            
            const k = 1024;
            const sizes = ['Ø¨Ø§ÙŠØª', 'ÙƒÙŠÙ„ÙˆØ¨Ø§ÙŠØª', 'Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª', 'Ø¬ÙŠØ¬Ø§Ø¨Ø§ÙŠØª'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', () => {
            setupEventListeners();
        });
    </script>
</body>
</html>
